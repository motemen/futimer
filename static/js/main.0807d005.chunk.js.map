{"version":3,"sources":["actions/index.ts","components/NavBar.tsx","components/Measurer.tsx","components/SessionRecords.tsx","components/Results.tsx","reducers/index.ts","registerServiceWorker.ts","components/tools/VideoRecorder.tsx","components/tools/ScramblePreview.tsx","components/tools/Stats.tsx","components/Tools.tsx","index.tsx","gateways/GoogleAPI.ts","services/SyncRecords.ts","models/index.ts","TNoodle.ts","../public/app.png"],"names":["createAction","actionCreatorFactory","Actions","recordAttempt","updateScramble","deleteRecord","updateSessionIsSynced","updateSyncSpreadsheetId","updateIsAuthed","changePuzzleType","changeToolType","changeIsPlaying","createNewSession","startRecordsUpload","finishRecordsUpload","deleteAllRecords","AsyncAction","syncRecords","dispatch","getState","a","sync","results","isSyncing","googleAPI","signIn","service","SyncRecords","spreadsheetId","getFile","file","id","sessionsToSync","map","index","session","isSynced","filter","length","uploadSession","resetScramble","puzzleType","current","setImmediate","generateScramble","then","scramble","commitRecord","payload","NavBar","handlePuzzleTypeChange","ev","props","puzzle","target","value","AppBar","position","elevation","Toolbar","Typography","variant","color","style","textTransform","marginRight","alt","src","Logo","width","height","Select","native","this","onChange","Object","keys","PuzzleConfiguration","sort","key","longName","React","connect","Measurer","state","startTime","animTimer","timerRef","prevScramble","record","focusVisible","handleWindowFocus","handleTimerContextMenu","preventDefault","handleButtonMount","actions","handleHoldStart","stopTimer","type","keycode","nativeEvent","holdStarted","setState","performance","now","handleHoldEnd","undefined","startTimer","window","removeEventListener","innerText","formatDuration","addEventListener","passive","className","classNames","classes","isLoading","ButtonBase","action","onTouchStart","onTouchEnd","onKeyDown","onKeyUp","onMouseDown","onMouseUp","component","focusRipple","root","button","timer","isHolding","Boolean","TouchRippleProps","childPulsate","buttonChildPulsate","onContextMenuCapture","ref","step","elapsed","Math","floor","requestAnimationFrame","isPlaying","Error","cancelAnimationFrame","time","timestamp","timing","navigationStart","withStyles","theme","createStyles","from","red","A700","to","green","palette","grey","transition","backgroundColor","text","primary","animation","display","fontSize","typography","h5","marginTop","spacing","marginLeft","textAlign","breakpoints","down","h2","h1","SessionRecords","handleRecordMoreClick","i","recordMenuAnchor","currentTarget","activeRecordIndex","handleRecordMenuClose","handleDeleteRecordClick","sessionIndex","resultIndex","recordIndex","stats","calcStats","records","ExpansionPanel","defaultExpanded","ExpansionPanelSummary","content","summaryContent","Hidden","xsDown","title","name","summary","n","st","averageOf","best","flex","actionButton","ExpansionPanelDetails","padding","Table","TableHead","TableRow","TableCell","number","TableBody","slice","reverse","formatTimestamp","align","IconButton","onClick","Icon","Menu","anchorEl","open","onClose","MenuItem","t","Date","toLocaleString","secondary","overflow","textOverflow","whiteSpace","paddingRight","flexBasis","up","Results","handleSyncClick","isAuthed","handleNewSessionClick","handleOpenSheetClick","url","handleDeleteAllRecordsClick","confirm","Paper","Tooltip","marginBottom","disabled","spacer","syncDone","auth","result","every","transform","margin","overflowX","borderRadius","splice","reducerWithInitialState","initialState","case","saveSession","currentSession","tool","toolType","selected","reducerWithoutInitialState","reducer","reduceReducers","combineReducers","isLocalhost","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","error","VideoRecorder","func","promise","once","mediaDevices","getUserMedia","video","stream","videoRef","srcObject","play","recorder","chunks","start","stop","close","getVideoTracks","MediaRecorder","ondataavailable","e","push","data","onstop","download","blob","Blob","URL","createObjectURL","document","createElement","href","click","muted","maxWidth","ScramblePreview","updatePreview","tnoodlejs","svg","scrambleToSvg","tnoodleImpl","innerHTML","querySelector","Stats","single","Tools","handleTypeChange","ToolType","renderContent","Recorder","Preview","on","GoogleAPIEvents","UPDATE_SIGNED_IN","signedIn","store","persistConfig","debug","process","storage","persistStorage","transforms","whitelist","rootReducer","persistReducer","createStore","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","applyMiddleware","thunkMiddleware","persister","persistStore","createMuiTheme","main","blue","ReactDOM","ThemeProvider","persistor","Grid","container","item","xs","md","smDown","getElementById","toString","origin","fetch","response","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","opts","SCRIPT_SOURCE","loadP","loadScriptP","load","loadScript","g","Promise","resolve","client","init","auth2","getAuthInstance","emit","isSignedIn","listen","reject","gapi","script","setAttribute","poll","setTimeout","appendChild","EventEmitter","clientId","discoveryDocs","scope","getFileP","values","gameLongName","ensureSheet","sheets","spreadsheets","append","range","valueInputOption","drive","files","list","orderBy","listResp","create","mimeType","createResp","some","sheet","properties","batchUpdate","requests","addSheet","scores","reduce","aa","array","Array","fill","_","slicesFrom","s","curr","v","min","worst","max","Number","MAX_VALUE","MIN_VALUE","variousAveragesOf","sorted","b","meanOf","c","subsecs","split","mins","secs","substring","minx","pyram","skewb","sq1","puzzlesLoaded","TNOODLE_LOAD_TIMEOUT","module","exports"],"mappings":"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","file":"static/js/main.0807d005.chunk.js","sourcesContent":["import { ThunkAction, ThunkDispatch } from \"redux-thunk\";\n\nimport actionCreatorFactory from \"typescript-fsa\";\n\nimport { SyncRecords } from \"../services/SyncRecords\";\nimport { googleAPI } from \"../gateways/GoogleAPI\";\nimport { PuzzleType, Record, ToolType, StoreState } from \"../models\";\nimport { generateScramble } from \"../TNoodle\";\n\nconst createAction = actionCreatorFactory();\n\nexport const Actions = {\n  recordAttempt: createAction<{ record: Record }>(\"RECORD_ATTEMPT\"),\n  updateScramble: createAction<{ scramble: string }>(\"UPDATE_SCRAMBLE\"),\n  deleteRecord: createAction<{ sessionIndex: number; recordIndex: number }>(\n    \"DELETE_RECORD\"\n  ),\n  updateSessionIsSynced: createAction<{ index: number; isSynced: boolean }>(\n    \"UPDATE_SESSION_IS_SYNCED\"\n  ),\n  updateSyncSpreadsheetId: createAction<{ spreadsheetId: string }>(\n    \"UPDATE_SYNC_SPREADSHEET_ID\"\n  ),\n  updateIsAuthed: createAction<{ isAuthed: boolean }>(\"UPDATE_IS_AUTHED\"),\n  changePuzzleType: createAction<{ puzzle: PuzzleType }>(\"CHANGE_PUZZLE_TYPE\"),\n  changeToolType: createAction<{ toolType: ToolType }>(\"CHANGE_TOOL_TYPE\"),\n  changeIsPlaying: createAction<{ isPlaying: boolean }>(\"CHANGE_IS_PLAYING\"),\n  createNewSession: createAction(\"CREATE_NEW_SESSION\"),\n  startRecordsUpload: createAction(\"START_RECORDS_UPLOAD\"),\n  finishRecordsUpload: createAction(\"FINISH_RECORDS_UPLOAD\"),\n  deleteAllRecords: createAction(\"DELETE_ALL_RECORDS\"),\n};\n\nexport const AsyncAction = {\n  syncRecords: () => async (dispatch: Dispatch, getState: () => StoreState) => {\n    const { sync, results } = getState();\n    if (sync.isSyncing) {\n      return;\n    }\n\n    await googleAPI.signIn();\n\n    const service = new SyncRecords(googleAPI);\n\n    let spreadsheetId = sync.spreadsheetId;\n    if (!spreadsheetId) {\n      const file = await service.getFile();\n      spreadsheetId = file.id!;\n      dispatch(Actions.updateSyncSpreadsheetId({ spreadsheetId }));\n    }\n\n    const sessionsToSync = results\n      .map(({ session, isSynced }, index) => ({ ...session, isSynced, index }))\n      .filter(({ isSynced }) => !isSynced);\n    if (sessionsToSync.length === 0) {\n      return;\n    }\n\n    dispatch(Actions.startRecordsUpload());\n\n    for (const session of sessionsToSync) {\n      await service.uploadSession(spreadsheetId, session);\n      dispatch(\n        Actions.updateSessionIsSynced({ index: session.index, isSynced: true })\n      );\n    }\n\n    dispatch(Actions.finishRecordsUpload());\n  },\n\n  resetScramble: () => (dispatch: Dispatch, getState: () => StoreState) => {\n    const {\n      current: {\n        session: { puzzleType },\n      },\n    } = getState();\n    setImmediate(() => {\n      generateScramble(puzzleType).then((scramble) => {\n        dispatch(Actions.updateScramble({ scramble }));\n      });\n    });\n  },\n\n  commitRecord: (payload: { record: Record }) => (\n    dispatch: ThunkDispatch<StoreState, never, Action>,\n    getState: () => StoreState\n  ) => {\n    dispatch(Actions.recordAttempt(payload));\n    dispatch(AsyncAction.resetScramble());\n  },\n\n  changePuzzleType: (payload: { puzzle: PuzzleType }) => (\n    dispatch: ThunkDispatch<StoreState, never, Action>\n  ) => {\n    dispatch(Actions.changePuzzleType(payload));\n    dispatch(AsyncAction.resetScramble());\n  },\n};\n\nexport type Action = ReturnType<typeof Actions[keyof typeof Actions]>;\n\nexport type AsyncAction = ThunkAction<void, StoreState, never, Action>;\n\nexport type Dispatch = ThunkDispatch<StoreState, never, Action>;\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { AppBar, Toolbar, Typography, Select } from \"@material-ui/core\";\n\nimport { PuzzleType, PuzzleConfiguration, StoreState } from \"../models\";\nimport { AsyncAction, Dispatch } from \"../actions\";\n\nimport Logo from \"../app.png\";\n\ninterface OwnProps {\n  puzzleType: PuzzleType;\n}\n\ntype Props = OwnProps & { dispatch: Dispatch };\n\nclass NavBar extends React.Component<Props> {\n  public render() {\n    return (\n      <AppBar position=\"static\" elevation={0}>\n        <Toolbar>\n          <Typography\n            variant=\"h6\"\n            color=\"inherit\"\n            style={{ textTransform: \"uppercase\", marginRight: 20 }}\n          >\n            <img\n              alt=\"fuTimer\"\n              src={Logo}\n              width=\"16\"\n              height=\"16\"\n              style={{ marginRight: 4 }}\n            />\n            fuTimer\n          </Typography>\n          <Select\n            native\n            value={this.props.puzzleType}\n            onChange={this.handlePuzzleTypeChange}\n          >\n            {(Object.keys(PuzzleConfiguration) as [\n              keyof typeof PuzzleConfiguration\n            ])\n              .sort()\n              .map((key) => {\n                return (\n                  <option value={key} key={key}>\n                    {PuzzleConfiguration[key].longName}\n                  </option>\n                );\n              })}\n          </Select>\n        </Toolbar>\n      </AppBar>\n    );\n  }\n\n  private handlePuzzleTypeChange = (\n    ev: React.ChangeEvent<{ value: unknown }>\n  ) => {\n    this.props.dispatch(\n      AsyncAction.changePuzzleType({ puzzle: ev.target.value as PuzzleType })\n    );\n  };\n}\n\nfunction mapStateToProps({\n  current: {\n    session: { puzzleType },\n  },\n}: StoreState) {\n  return {\n    puzzleType,\n  };\n}\n\nexport default connect(mapStateToProps)(NavBar);\n","import * as React from \"react\";\nimport { SyntheticEvent } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport keycode from \"keycode\";\nimport classNames from \"classnames\";\n\nimport {\n  ButtonBase,\n  createStyles,\n  Theme,\n  WithStyles,\n  withStyles,\n} from \"@material-ui/core\";\nimport { green, red } from \"@material-ui/core/colors\";\n\nimport { ButtonBaseActions } from \"@material-ui/core/ButtonBase\";\nimport { Actions, AsyncAction, Dispatch } from \"../actions\";\nimport { formatDuration, Record, StoreState } from \"../models\";\n\ninterface OwnProps {\n  scramble?: string;\n}\n\ntype Props = OwnProps & { dispatch: Dispatch } & WithStyles<typeof Styles>;\n\ninterface State {\n  holdStarted?: number;\n}\n\nconst HOLD_DURATION = 550;\n\nconst Styles = (theme: Theme) =>\n  createStyles({\n    \"@keyframes holding-color-change\": {\n      from: { color: red.A700 },\n      to: { color: green.A700 },\n    },\n    button: {\n      color: theme.palette.grey[\"300\"],\n      transition: \"color 0.25s\",\n      \"&:focus\": {\n        backgroundColor: \"#eee\",\n        color: theme.palette.text.primary,\n      },\n    },\n    buttonChildPulsate: {\n      animation: \"none\",\n      display: \"none\",\n    },\n    isHolding: {\n      animation: `${HOLD_DURATION}ms step-end $holding-color-change both`,\n    },\n    scramble: {\n      fontSize: theme.typography.h5.fontSize,\n      marginTop: theme.spacing(3),\n      marginLeft: theme.spacing(),\n      marginRight: theme.spacing(),\n      textAlign: \"center\",\n      transition: \"color 0.5s\",\n    },\n    timer: {\n      [theme.breakpoints.down(\"xs\")]: {\n        fontSize: theme.typography.h2.fontSize,\n      },\n      fontSize: theme.typography.h1.fontSize,\n      padding: theme.spacing(2),\n      margin: `${theme.spacing(3)}px 0`,\n      textAlign: \"center\",\n      width: \"100%\",\n      touchAction: \"none\",\n      WebkitTouchCallout: \"none\",\n      userSelect: \"none\",\n    },\n    isLoading: {\n      color: theme.palette.grey[\"300\"],\n    },\n  });\n\nclass Measurer extends React.Component<Props, State> {\n  public state: State = {};\n\n  private startTime: number | null = null;\n  private animTimer: number | null = null;\n  private timerRef: React.RefObject<HTMLPreElement>;\n  private prevScramble?: string;\n  private record: Record | null = null;\n\n  private focusVisible?: () => void;\n\n  constructor(props: Props) {\n    super(props);\n    this.timerRef = React.createRef();\n  }\n\n  public handleWindowFocus = () => {\n    this.focusVisible!();\n  };\n\n  public componentWillMount() {\n    this.props.dispatch(AsyncAction.resetScramble());\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener(\"focus\", this.handleWindowFocus);\n  }\n\n  public componentDidMount() {\n    this.timerRef.current!.innerText = formatDuration(0);\n    window.addEventListener(\"focus\", this.handleWindowFocus, { passive: true });\n  }\n\n  public componentWillReceiveProps() {\n    this.prevScramble = this.props.scramble;\n  }\n\n  public render() {\n    return (\n      <div>\n        <div\n          className={classNames(this.props.classes.scramble, {\n            [this.props.classes.isLoading]: !this.props.scramble,\n          })}\n        >\n          <code>\n            {this.props.scramble || this.prevScramble || \"Generating…\"}\n          </code>\n        </div>\n        <ButtonBase\n          action={this.handleButtonMount}\n          onTouchStart={this.handleHoldStart}\n          onTouchEnd={this.handleHoldEnd}\n          onKeyDown={this.handleHoldStart}\n          onKeyUp={this.handleHoldEnd}\n          onMouseDown={this.handleHoldStart}\n          onMouseUp={this.handleHoldEnd}\n          component=\"button\"\n          focusRipple={true}\n          classes={{\n            root: classNames(\n              this.props.classes.button,\n              this.props.classes.timer,\n              {\n                [this.props.classes.isHolding]:\n                  this.state && Boolean(this.state.holdStarted),\n              }\n            ),\n          }}\n          TouchRippleProps={{\n            classes: {\n              childPulsate: this.props.classes.buttonChildPulsate,\n            },\n          }}\n          onContextMenuCapture={this.handleTimerContextMenu}\n        >\n          <pre ref={this.timerRef} />\n        </ButtonBase>\n      </div>\n    );\n  }\n\n  private handleTimerContextMenu = (ev: SyntheticEvent) => {\n    ev.preventDefault();\n  };\n\n  private handleButtonMount = (actions: ButtonBaseActions) => {\n    actions.focusVisible();\n    this.focusVisible = actions.focusVisible;\n  };\n\n  private handleHoldStart = (ev: React.SyntheticEvent) => {\n    if (this.startTime) {\n      // any key is accepted\n      this.stopTimer();\n      return;\n    }\n\n    if (this.record) {\n      return;\n    }\n\n    if (ev.type === \"keydown\") {\n      if (keycode(ev.nativeEvent) !== \"space\") {\n        return;\n      }\n    }\n\n    if (!this.startTime && !this.state.holdStarted) {\n      this.setState({ holdStarted: performance.now() });\n    }\n  };\n\n  private handleHoldEnd = (ev: React.SyntheticEvent) => {\n    if (ev.type === \"keyup\") {\n      if (keycode(ev.nativeEvent) !== \"space\") {\n        return;\n      }\n    }\n\n    if (this.record) {\n      const record = { ...this.record };\n      this.props.dispatch(AsyncAction.commitRecord({ record }));\n      this.record = null;\n      return;\n    }\n\n    const { holdStarted } = this.state;\n    if (!holdStarted) {\n      return;\n    }\n\n    this.setState({ holdStarted: undefined });\n\n    if (performance.now() - holdStarted <= HOLD_DURATION) {\n      return;\n    }\n\n    if (this.startTime === null) {\n      this.startTimer();\n    }\n  };\n\n  private startTimer() {\n    this.record = null;\n\n    const step = () => {\n      if (!this.startTime) {\n        this.startTime = performance.now();\n      }\n      const elapsed = Math.floor(performance.now() - this.startTime) / 1000;\n      this.timerRef.current!.innerText = formatDuration(elapsed);\n      this.animTimer = window.requestAnimationFrame(step);\n    };\n    step();\n\n    this.props.dispatch(Actions.changeIsPlaying({ isPlaying: true }));\n  }\n\n  private stopTimer() {\n    if (!this.animTimer || !this.startTime) {\n      throw new Error(\"stopTimer: invalid state\");\n    }\n\n    window.cancelAnimationFrame(this.animTimer);\n\n    const elapsed = Math.floor(performance.now() - this.startTime) / 1000;\n    this.timerRef.current!.innerText = formatDuration(elapsed);\n\n    // this dispatch could be heavy (as it involves generating scrambles),\n    // we prefer rendering elapsed time by delaying dispatch\n    this.record = {\n      scramble: this.props.scramble!,\n      time: elapsed,\n      timestamp: performance.timing.navigationStart + this.startTime,\n    };\n\n    this.animTimer = null;\n    this.startTime = null;\n\n    this.props.dispatch(Actions.changeIsPlaying({ isPlaying: false }));\n  }\n}\n\nfunction mapStateToProps({ current: { scramble } }: StoreState) {\n  return {\n    scramble,\n  };\n}\n\nexport default connect(mapStateToProps)(withStyles(Styles)(Measurer));\n","import * as React from \"react\";\n\nimport { connect } from \"react-redux\";\n\nimport {\n  createStyles,\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary,\n  Hidden,\n  Icon,\n  IconButton,\n  Menu,\n  MenuItem,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n  Theme,\n  Typography,\n  withStyles,\n  WithStyles,\n} from \"@material-ui/core\";\n\nimport { Actions, Dispatch } from \"../actions\";\nimport {\n  calcStats,\n  formatDuration,\n  Session,\n  PuzzleConfiguration,\n} from \"../models\";\n\ninterface OwnProps {\n  resultIndex: number;\n  session: Session;\n  defaultExpanded?: boolean;\n  actionButton?: React.ReactNode;\n}\n\ninterface State {\n  recordMenuAnchor?: HTMLElement;\n  activeRecordIndex?: number;\n}\n\nconst Styles = (theme: Theme) =>\n  createStyles({\n    scramble: {\n      [theme.breakpoints.down(\"xs\")]: {\n        display: \"none\",\n      },\n    },\n    summary: {\n      color: theme.palette.text.secondary,\n      overflow: \"hidden\",\n      textOverflow: \"ellipsis\",\n      whiteSpace: \"nowrap\",\n    },\n    summaryContent: {\n      \"& > :last-child\": {\n        paddingRight: 0,\n      },\n    },\n    timestamp: {\n      [theme.breakpoints.down(\"xs\")]: {\n        display: \"none\",\n      },\n    },\n    number: {},\n    title: {\n      flexBasis: \"20%\",\n    },\n    root: {\n      paddingRight: \"16px !important\",\n      [theme.breakpoints.up(\"sm\")]: {\n        paddingRight: \"24px !important\",\n      },\n    },\n  });\n\nclass SessionRecords extends React.Component<\n  OwnProps & { dispatch: Dispatch } & WithStyles<typeof Styles>,\n  State\n> {\n  public state: Readonly<State> = {};\n\n  public render() {\n    const stats = calcStats(this.props.session.records);\n\n    return (\n      <ExpansionPanel defaultExpanded={this.props.defaultExpanded}>\n        <ExpansionPanelSummary\n          classes={{\n            content: this.props.classes.summaryContent,\n            root: this.props.classes.root,\n          }}\n        >\n          <Hidden xsDown={true}>\n            <Typography className={this.props.classes.title}>\n              {this.props.resultIndex === -1\n                ? \"Current Session\"\n                : this.props.session.name}{\" \"}\n              ({PuzzleConfiguration[this.props.session.puzzleType].longName})\n            </Typography>\n          </Hidden>\n          <Typography className={this.props.classes.summary} component=\"div\">\n            {[100, 12, 5].map((n) => {\n              const st = stats.averageOf[n];\n              if (!st) {\n                return null;\n              }\n\n              return (\n                <div key={n}>\n                  <Hidden xsDown={true}>\n                    Best ao\n                    {n}: {formatDuration(st.best) || \"N/A\"}\n                  </Hidden>{\" \"}\n                  <Hidden xsDown={true}>Curr </Hidden>\n                  <span>\n                    ao\n                    {n}: {formatDuration(st.current) || \"N/A\"}\n                  </span>\n                </div>\n              );\n            })}\n          </Typography>\n          <div style={{ flex: 1 }} />\n          {this.props.actionButton}\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails style={{ padding: 0 }}>\n          <Table>\n            <TableHead>\n              <TableRow>\n                <TableCell className={this.props.classes.number}>#</TableCell>\n                <TableCell className={this.props.classes.timestamp}>\n                  Timestamp\n                </TableCell>\n                <TableCell className={this.props.classes.scramble}>\n                  Scramble\n                </TableCell>\n                <TableCell>Time</TableCell>\n                <TableCell />\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {this.props.session.records\n                .slice()\n                .reverse()\n                .map((record, i) => {\n                  const recordIndex =\n                    this.props.session.records.length - (i + 1);\n                  return (\n                    <TableRow key={recordIndex}>\n                      <TableCell className={this.props.classes.number}>\n                        {recordIndex + 1}\n                      </TableCell>\n                      <TableCell className={this.props.classes.timestamp}>\n                        {this.formatTimestamp(record.timestamp)}\n                      </TableCell>\n                      <TableCell className={this.props.classes.scramble}>\n                        <code>{record.scramble}</code>\n                      </TableCell>\n                      <TableCell align=\"right\">\n                        <code>{formatDuration(record.time)}</code>\n                      </TableCell>\n                      <TableCell padding=\"checkbox\">\n                        <IconButton\n                          onClick={this.handleRecordMoreClick(recordIndex)}\n                        >\n                          <Icon>more_vert</Icon>\n                        </IconButton>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n            </TableBody>\n          </Table>\n          <Menu\n            anchorEl={this.state.recordMenuAnchor}\n            open={Boolean(this.state.recordMenuAnchor)}\n            onClose={this.handleRecordMenuClose}\n          >\n            <MenuItem onClick={this.handleDeleteRecordClick}>Delete</MenuItem>\n          </Menu>\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    );\n  }\n\n  private handleRecordMoreClick = (i: number) => (\n    ev: React.MouseEvent<HTMLElement>\n  ) => {\n    this.setState({ recordMenuAnchor: ev.currentTarget, activeRecordIndex: i });\n  };\n\n  private handleRecordMenuClose = () => {\n    this.setState({ recordMenuAnchor: undefined });\n  };\n\n  private handleDeleteRecordClick = () => {\n    this.props.dispatch(\n      Actions.deleteRecord({\n        sessionIndex: this.props.resultIndex,\n        recordIndex: this.state.activeRecordIndex!,\n      })\n    );\n    this.handleRecordMenuClose();\n  };\n\n  private formatTimestamp(t: number) {\n    return new Date(t).toLocaleString();\n  }\n}\n\nexport default connect()(withStyles(Styles)(SessionRecords));\n","import * as React from \"react\";\n\nimport { connect } from \"react-redux\";\n\nimport {\n  createStyles,\n  Icon,\n  IconButton,\n  Paper,\n  Theme,\n  Toolbar,\n  Typography,\n  withStyles,\n  WithStyles,\n  Tooltip,\n} from \"@material-ui/core\";\n\nimport classNames from \"classnames\";\n\nimport { Actions, AsyncAction, Dispatch } from \"../actions\";\nimport { calcStats, ResultStats, Session, StoreState } from \"../models\";\nimport SessionRecords from \"./SessionRecords\";\n\ninterface OwnProps {\n  isAuthed?: boolean;\n  isSyncing: boolean;\n  results: Array<{\n    session: Session;\n    stats: ResultStats;\n    isSynced: boolean;\n  }>;\n  spreadsheetId?: string;\n  syncDone: boolean;\n  session: Session;\n}\n\ntype Props = OwnProps & { dispatch: Dispatch } & WithStyles<typeof Styles>;\n\ninterface State {\n  recordMenuAnchor?: HTMLElement;\n  activeRecordIndex?: number;\n}\n\nconst Styles = (theme: Theme) =>\n  createStyles({\n    \"@keyframes spin-l\": {\n      from: { transform: \"rotate(0deg)\" },\n      to: { transform: \"rotate(-360deg)\" },\n    },\n    isSyncing: {\n      animation: \"$spin-l 1.5s linear infinite\",\n    },\n    root: {\n      margin: theme.spacing(2),\n      marginTop: 0,\n      overflowX: \"auto\",\n      [theme.breakpoints.down(\"sm\")]: {\n        marginLeft: 0,\n        marginRight: 0,\n        borderRadius: 0,\n      },\n    },\n    spacer: {\n      flex: \"1\",\n    },\n    title: {\n      flexBasis: \"20%\",\n    },\n  });\n\nclass Results extends React.Component<Props, State> {\n  public state: Readonly<State> = {};\n\n  public render() {\n    return (\n      <div>\n        <Paper className={this.props.classes.root} elevation={1}>\n          <SessionRecords\n            session={this.props.session}\n            resultIndex={-1}\n            defaultExpanded={true}\n            actionButton={\n              <Tooltip title=\"Save records\">\n                <div>\n                  <IconButton\n                    style={{ marginTop: -16, marginBottom: -16 }}\n                    onClick={this.handleNewSessionClick}\n                    disabled={this.props.session.records.length === 0}\n                  >\n                    <Icon>save</Icon>\n                  </IconButton>\n                </div>\n              </Tooltip>\n            }\n          />\n        </Paper>\n        <Paper className={this.props.classes.root} elevation={1}>\n          <Toolbar>\n            <Typography>History</Typography>\n            <div className={this.props.classes.spacer} />\n            {this.props.isAuthed && this.props.spreadsheetId ? (\n              <Tooltip title=\"Open spreadsheet\">\n                <IconButton onClick={this.handleOpenSheetClick}>\n                  <Icon>open_in_new</Icon>\n                </IconButton>\n              </Tooltip>\n            ) : null}\n            <Tooltip title=\"Delete records\">\n              <div>\n                <IconButton\n                  onClick={this.handleDeleteAllRecordsClick}\n                  disabled={this.props.results.length === 0}\n                >\n                  <Icon>delete</Icon>\n                </IconButton>\n              </div>\n            </Tooltip>\n            <IconButton onClick={this.handleSyncClick}>\n              {this.props.isAuthed ? (\n                this.props.syncDone ? (\n                  <Tooltip title=\"Synced all records\">\n                    <Icon>cloud_done</Icon>\n                  </Tooltip>\n                ) : (\n                  <Tooltip title=\"Sync records\">\n                    <Icon\n                      className={classNames({\n                        [this.props.classes.isSyncing]: this.props.isSyncing,\n                      })}\n                    >\n                      sync\n                    </Icon>\n                  </Tooltip>\n                )\n              ) : this.props.isAuthed === false ? (\n                <Icon>cloud_off</Icon>\n              ) : (\n                <Icon color=\"disabled\">cloud_off</Icon>\n              )}\n            </IconButton>\n          </Toolbar>\n          {this.props.results.map(({ session, stats }, resultIndex) => {\n            return (\n              <SessionRecords\n                session={session}\n                resultIndex={resultIndex}\n                key={resultIndex}\n              />\n            );\n          })}\n        </Paper>\n      </div>\n    );\n  }\n\n  private handleSyncClick = () => {\n    if (this.props.isAuthed === undefined) {\n      // loading. do not try to sync yet\n      return;\n    }\n\n    this.props.dispatch(AsyncAction.syncRecords());\n  };\n\n  private handleNewSessionClick = () => {\n    this.props.dispatch(Actions.createNewSession());\n  };\n\n  private handleOpenSheetClick = () => {\n    const url = `https://docs.google.com/spreadsheets/d/${this.props.spreadsheetId}/edit`;\n    window.open(url);\n  };\n\n  private handleDeleteAllRecordsClick = () => {\n    // eslint-disable-next-line no-restricted-globals\n    if (confirm(\"Delete all records?\")) {\n      this.props.dispatch(Actions.deleteAllRecords());\n    }\n  };\n}\n\nfunction mapStateToProps({\n  current: { session },\n  results,\n  auth: { isAuthed },\n  sync: { isSyncing, spreadsheetId },\n}: StoreState) {\n  return {\n    isAuthed,\n    isSyncing,\n    results: results.map((result) => ({\n      ...result,\n      stats: calcStats(result.session.records),\n    })),\n    spreadsheetId,\n    syncDone: results.every(({ isSynced }) => isSynced),\n    session,\n  };\n}\n\nexport default connect(mapStateToProps)(withStyles(Styles)(Results));\n","import { Reducer, combineReducers } from \"redux\";\n\nimport {\n  reducerWithInitialState,\n  reducerWithoutInitialState,\n} from \"typescript-fsa-reducers\";\n\nimport { Actions } from \"../actions\";\nimport { PuzzleType, Session, StoreState, initialState } from \"../models\";\n\nimport reduceReducers from \"reduce-reducers\";\n\nconst deleteRecord = (session: Session, index: number): Session => {\n  const records = session.records;\n  records.splice(index, 1);\n  return {\n    ...session,\n    records,\n  };\n};\n\nexport const current = reducerWithInitialState<StoreState[\"current\"]>(\n  initialState.current\n)\n  .case(Actions.deleteRecord, (state, { sessionIndex, recordIndex }) => {\n    if (sessionIndex === -1) {\n      return {\n        ...state,\n        session: deleteRecord(state.session, recordIndex),\n      };\n    }\n    return state;\n  })\n  .case(Actions.updateScramble, (state, { scramble }) => {\n    return {\n      ...state,\n      scramble,\n    };\n  })\n  .case(Actions.recordAttempt, (state, { record }) => {\n    if (!state.scramble) {\n      return state;\n    }\n\n    return {\n      ...state,\n      scramble: undefined,\n      session: {\n        ...state.session,\n        records: [...state.session.records, record],\n      },\n    };\n  });\n\nexport const sync = reducerWithInitialState<StoreState[\"sync\"]>(\n  initialState.sync\n)\n  .case(Actions.startRecordsUpload, (state) => {\n    return {\n      ...state,\n      isSyncing: true,\n    };\n  })\n  .case(Actions.finishRecordsUpload, (state) => {\n    return {\n      ...state,\n      isSyncing: false,\n    };\n  })\n  .case(Actions.updateSyncSpreadsheetId, (state, { spreadsheetId }) => {\n    return {\n      ...state,\n      spreadsheetId,\n    };\n  });\n\nconst results = reducerWithInitialState<StoreState[\"results\"]>(\n  initialState.results\n)\n  .case(Actions.deleteRecord, (state, { sessionIndex, recordIndex }) => {\n    return state\n      .map((result, i) => {\n        if (i === sessionIndex) {\n          return {\n            ...result,\n            session: deleteRecord(result.session, recordIndex),\n          };\n        }\n\n        return result;\n      })\n      .filter(({ session: { records } }) => {\n        return records.length > 0;\n      });\n  })\n  .case(Actions.updateSessionIsSynced, (state, { index, isSynced }) => {\n    return state.map((result, i) => {\n      if (i === index) {\n        return {\n          ...result,\n          isSynced,\n        };\n      }\n\n      return result;\n    });\n  })\n  .case(Actions.deleteAllRecords, (state, action) => {\n    return [];\n  });\n\nexport const auth = reducerWithInitialState<StoreState[\"auth\"]>(\n  initialState.auth\n).case(Actions.updateIsAuthed, (state, { isAuthed }) => {\n  return {\n    ...state,\n    isAuthed,\n  };\n});\n\nfunction saveSession(state: StoreState, puzzleType?: PuzzleType): StoreState {\n  const currentSession = state.current.session;\n\n  return {\n    ...state,\n    current: {\n      ...state.current,\n      scramble:\n        (puzzleType || currentSession.puzzleType) === currentSession.puzzleType\n          ? state.current.scramble\n          : undefined,\n      session: {\n        puzzleType: puzzleType || currentSession.puzzleType,\n        records: [],\n      },\n    },\n    results:\n      currentSession.records.length === 0\n        ? state.results\n        : [\n            {\n              isSynced: false,\n              session: {\n                ...currentSession,\n                name: new Date(\n                  currentSession.records[0].timestamp\n                ).toLocaleString(),\n              },\n            },\n            ...state.results,\n          ],\n  };\n}\n\nexport const tool = reducerWithInitialState<StoreState[\"tool\"]>(\n  initialState.tool\n).case(Actions.changeToolType, (state, { toolType }) => {\n  return {\n    ...state,\n    selected: toolType,\n  };\n});\n\nexport const root = reducerWithoutInitialState<StoreState>()\n  .case(Actions.changeIsPlaying, (state, { isPlaying }) => {\n    return {\n      ...state,\n      isPlaying,\n    };\n  })\n  .case(Actions.createNewSession, (state) => {\n    return saveSession(state);\n  })\n  .case(Actions.changePuzzleType, (state, { puzzle }) => {\n    return saveSession(state, puzzle);\n  });\n\nexport const reducer = reduceReducers(\n  root,\n  combineReducers({ current, sync, auth, results, tool })\n) as Reducer<StoreState>;\n","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://goo.gl/SC7cgQ\"\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === \"installed\") {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log(\"New content is available; please refresh.\");\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log(\"Content is cached for offline use.\");\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get(\"content-type\")!.indexOf(\"javascript\") === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { StoreState } from \"../../models\";\n\ninterface Props {\n  isPlaying?: boolean;\n  scramble?: string;\n}\n\nclass VideoRecorder extends React.Component<Props> {\n  public open = once(async () => {\n    this.stream = await navigator.mediaDevices.getUserMedia({ video: true });\n    this.videoRef.current!.srcObject = this.stream;\n    this.videoRef.current!.play();\n  });\n\n  private recorder?: MediaRecorder;\n  private chunks?: BlobPart[];\n  private videoRef: React.RefObject<HTMLVideoElement>;\n  private stream?: MediaStream;\n\n  constructor(props: {}) {\n    super(props);\n    this.videoRef = React.createRef();\n  }\n\n  public componentWillReceiveProps({ isPlaying }: Props) {\n    if (!!this.props.isPlaying === !!isPlaying) {\n      return;\n    }\n\n    if (isPlaying) {\n      this.start();\n    } else {\n      this.stop();\n    }\n  }\n\n  public componentDidMount() {\n    this.open();\n  }\n\n  public componentWillUnmount() {\n    this.close();\n  }\n\n  public close() {\n    if (this.stream) {\n      for (const v of this.stream.getVideoTracks()) {\n        v.stop();\n      }\n      this.stream = undefined;\n    }\n  }\n\n  public async start() {\n    if (!this.stream) {\n      await this.open();\n    }\n    this.chunks = [];\n    this.recorder = new MediaRecorder(this.stream!);\n    this.recorder.ondataavailable = (e: any) => {\n      this.chunks!.push(e.data);\n    };\n    this.recorder.onstop = (e: any) => {\n      this.download();\n    };\n    this.recorder.start();\n  }\n\n  public stop() {\n    if (this.recorder) {\n      this.recorder.stop();\n    }\n  }\n\n  public download() {\n    const blob = new Blob(this.chunks);\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `${this.props.scramble || \"record\"}.webm`;\n    a.click();\n  }\n\n  public render() {\n    return (\n      <div>\n        <video muted ref={this.videoRef} style={{ maxWidth: \"100%\" }} />\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ isPlaying, current: { scramble } }: StoreState) {\n  return { isPlaying, scramble };\n}\n\nfunction once<T>(func: () => Promise<T>): () => Promise<T> {\n  let promise: Promise<T> | null = null;\n\n  return async () => {\n    promise = promise || func();\n    return await promise;\n  };\n}\n\nexport default connect(mapStateToProps)(VideoRecorder);\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { PuzzleType, PuzzleConfiguration, StoreState } from \"../../models\";\n\ninterface Props {\n  puzzleType: PuzzleType;\n  scramble?: string;\n}\n\nclass ScramblePreview extends React.Component<Props> {\n  private ref: React.RefObject<HTMLDivElement> = React.createRef();\n\n  public componentDidMount() {\n    this.updatePreview(this.props);\n  }\n\n  public componentWillReceiveProps({ puzzleType, scramble }: Props) {\n    if (\n      this.props.puzzleType === puzzleType &&\n      this.props.scramble === scramble\n    ) {\n      return;\n    }\n\n    this.updatePreview({ scramble, puzzleType });\n  }\n\n  public render() {\n    return <div ref={this.ref}>preview</div>;\n  }\n\n  private updatePreview({ scramble, puzzleType }: Props) {\n    if (typeof tnoodlejs === \"undefined\") {\n      return; // TODO\n    }\n\n    const svg = tnoodlejs.scrambleToSvg(\n      scramble,\n      new puzzle[PuzzleConfiguration[puzzleType].tnoodleImpl]()\n    );\n    this.ref.current!.innerHTML = svg;\n    this.ref.current!.querySelector(\"svg\")!.style.width = \"100%\";\n    this.ref.current!.querySelector(\"svg\")!.style.height = \"auto\";\n  }\n}\n\nfunction mapStateToProps({\n  current: {\n    scramble,\n    session: { puzzleType },\n  },\n}: StoreState) {\n  return {\n    puzzleType,\n    scramble,\n  };\n}\n\nexport default connect(mapStateToProps)(ScramblePreview);\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { Record, calcStats, formatDuration, StoreState } from \"../../models\";\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n} from \"@material-ui/core\";\n\ninterface Props {\n  records: Record[];\n}\n\nclass Stats extends React.Component<Props> {\n  public render() {\n    const stats = calcStats(this.props.records);\n\n    return (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell />\n            <TableCell>Current</TableCell>\n            <TableCell>Best</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {[1, 5, 12, 100].map((n) => {\n            const st = n === 1 ? stats.single : stats.averageOf[n];\n            if (!st) {\n              return null;\n            }\n\n            return (\n              <TableRow key={n}>\n                <TableCell>{n === 1 ? \"single\" : `ao${n}`}</TableCell>\n                <TableCell>{formatDuration(st.current)}</TableCell>\n                <TableCell>{formatDuration(st.best)}</TableCell>\n              </TableRow>\n            );\n          })}\n        </TableBody>\n      </Table>\n    );\n  }\n}\n\nfunction mapStateToProps({\n  current: {\n    session: { records },\n  },\n}: StoreState) {\n  return {\n    records,\n  };\n}\n\nexport default connect(mapStateToProps)(Stats);\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  Select,\n  Paper,\n  Typography,\n  Toolbar,\n  createStyles,\n  Theme,\n  withStyles,\n  WithStyles,\n} from \"@material-ui/core\";\n\nimport VideoRecorder from \"./tools/VideoRecorder\";\nimport ScramblePreview from \"./tools/ScramblePreview\";\nimport Stats from \"./tools/Stats\";\nimport { ToolType, StoreState } from \"../models\";\nimport { Dispatch, Actions } from \"../actions\";\n\nconst Styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      marginRight: theme.spacing(2),\n    },\n    content: {\n      padding: theme.spacing(),\n    },\n  });\n\ninterface OwnProps {\n  selected: ToolType;\n}\n\ntype Props = OwnProps & WithStyles<typeof Styles> & { dispatch: Dispatch };\n\nclass Tools extends React.Component<Props> {\n  public render() {\n    return (\n      <Paper elevation={1} className={this.props.classes.root}>\n        <Toolbar>\n          <Typography style={{ marginRight: 20 }}>Tools</Typography>\n          <Select\n            native\n            value={this.props.selected}\n            onChange={this.handleTypeChange}\n          >\n            {(Object.keys(ToolType) as [keyof typeof ToolType])\n              .sort()\n              .map((key) => {\n                return (\n                  <option value={ToolType[key]} key={key}>\n                    {key}\n                  </option>\n                );\n              })}\n          </Select>\n        </Toolbar>\n        <div className={this.props.classes.content}>{this.renderContent()}</div>\n      </Paper>\n    );\n  }\n\n  private handleTypeChange = (ev: React.ChangeEvent<any>) => {\n    this.props.dispatch(Actions.changeToolType({ toolType: ev.target.value }));\n  };\n\n  private renderContent(): React.ReactNode {\n    const builder =\n      {\n        [ToolType.Recorder]: () => <VideoRecorder />,\n        [ToolType.Stats]: () => <Stats />,\n        [ToolType.Preview]: () => <ScramblePreview />,\n      }[this.props.selected] || (() => <span>stats</span>);\n    return builder();\n  }\n}\n\nfunction mapStateToProps({ tool: { selected } }: StoreState) {\n  return { selected };\n}\n\nexport default connect(mapStateToProps)(withStyles(Styles)(Tools));\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { applyMiddleware, compose, createStore } from \"redux\";\nimport { persistReducer, persistStore } from \"redux-persist\";\nimport { PersistGate } from \"redux-persist/integration/react\";\nimport persistStorage from \"redux-persist/lib/storage\";\nimport thunkMiddleware from \"redux-thunk\";\n\nimport { Actions } from \"./actions\";\nimport NavBar from \"./components/NavBar\";\nimport Measurer from \"./components/Measurer\";\nimport Results from \"./components/Results\";\nimport { reducer } from \"./reducers\";\n\nimport \"./App.css\";\nimport \"./index.css\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nimport { googleAPI, GoogleAPIEvents } from \"./gateways/GoogleAPI\";\n\nimport { createMuiTheme, Grid, Hidden } from \"@material-ui/core\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport { blue } from \"@material-ui/core/colors\";\n\nimport { SyncRecords } from \"./services/SyncRecords\";\nimport Tools from \"./components/Tools\";\n\ngoogleAPI.on(GoogleAPIEvents.UPDATE_SIGNED_IN, async (signedIn) => {\n  store.dispatch(Actions.updateIsAuthed({ isAuthed: signedIn }));\n\n  const { sync } = store.getState();\n  if (!sync.spreadsheetId) {\n    const syncRecords = new SyncRecords(googleAPI);\n    const file = await syncRecords.getFile();\n    store.dispatch(\n      Actions.updateSyncSpreadsheetId({ spreadsheetId: file.id! })\n    );\n  }\n});\n\nconst persistConfig = {\n  debug: process.env.NODE_ENV !== \"production\",\n  key: \"root\",\n  storage: persistStorage,\n  transforms: [],\n  whitelist: [\"current\", \"results\", \"tool\"],\n};\n\nconst rootReducer = persistReducer(persistConfig, reducer);\n\nconst store = createStore(\n  rootReducer,\n  ((window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose)(\n    applyMiddleware(thunkMiddleware)\n  )\n);\n\nconst persister = persistStore(store);\n\n(window as any).store = store;\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: { main: \"#ef0\" },\n    secondary: { main: blue.A700 },\n  },\n});\n\nReactDOM.render(\n  <ThemeProvider theme={theme}>\n    <Provider store={store}>\n      <PersistGate persistor={persister}>\n        <NavBar />\n        <Measurer />\n        <Grid container>\n          <Grid item xs={12} md={8}>\n            <Results />\n          </Grid>\n          <Hidden smDown>\n            <Grid item md={4}>\n              <Tools />\n            </Grid>\n          </Hidden>\n        </Grid>\n      </PersistGate>\n    </Provider>\n  </ThemeProvider>,\n  document.getElementById(\"root\") as HTMLElement\n);\n\nregisterServiceWorker();\n","// ref:\n// - https://developers.google.com/drive/v3/web/quickstart/js\n// - https://developers.google.com/api-client-library/javascript/reference/referencedocs\n\nimport { EventEmitter } from \"events\";\n\n// tslint:disable-next-line:no-namespace\nexport interface GoogleAPIOptions {\n  apiKey?: string;\n  discoveryDocs: string[];\n  clientId: string;\n  scope: string;\n}\n\ntype GAPI = typeof gapi;\n\nexport enum GoogleAPIEvents {\n  UPDATE_SIGNED_IN = \"updateSignedIn\",\n}\nexport class GoogleAPI extends EventEmitter {\n  private readonly SCRIPT_SOURCE = \"https://apis.google.com/js/api.js\";\n\n  private loadP?: Promise<GAPI>;\n  private loadScriptP?: Promise<GAPI>;\n\n  constructor(private readonly opts: GoogleAPIOptions) {\n    super();\n    this.load();\n  }\n\n  public load(): Promise<GAPI> {\n    return (\n      this.loadP ||\n      (this.loadP = (async () => {\n        const g = await this.loadScript();\n        await new Promise((resolve) => g.load(\"client:auth2\", resolve));\n        await g.client.init(this.opts);\n        const auth = g.auth2.getAuthInstance();\n        if (auth) {\n          this.emit(GoogleAPIEvents.UPDATE_SIGNED_IN, auth.isSignedIn.get());\n          auth.isSignedIn.listen((signedIn) =>\n            this.emit(GoogleAPIEvents.UPDATE_SIGNED_IN, signedIn)\n          );\n        }\n        return g;\n      })())\n    );\n  }\n\n  public async signIn(): Promise<void> {\n    const g = await this.load();\n    return new Promise<void>((resolve, reject) => {\n      const auth = g.auth2.getAuthInstance();\n      if (auth.isSignedIn.get()) {\n        resolve();\n        return;\n      }\n\n      this.once(GoogleAPIEvents.UPDATE_SIGNED_IN, (signedIn: boolean) => {\n        if (signedIn) {\n          resolve();\n        } else {\n          reject();\n        }\n      });\n\n      auth.signIn();\n    });\n  }\n\n  private loadScript(): Promise<GAPI> {\n    if (typeof gapi !== \"undefined\") {\n      return Promise.resolve(gapi);\n    }\n\n    if (this.loadScriptP) {\n      return this.loadScriptP;\n    }\n\n    return (this.loadScriptP = new Promise<GAPI>((resolve, reject) => {\n      const script = document.createElement(\"script\");\n      script.setAttribute(\"src\", this.SCRIPT_SOURCE);\n      script.addEventListener(\"load\", () => {\n        this.loadScriptP = undefined;\n        const poll = () => {\n          if (typeof gapi !== \"undefined\") {\n            resolve(gapi);\n            return;\n          }\n          setTimeout(poll, 50);\n        };\n        poll();\n      });\n      script.addEventListener(\"error\", (ev: ErrorEvent) => {\n        this.loadScriptP = undefined;\n        reject(`Failed to load ${this.SCRIPT_SOURCE}`);\n      });\n      document.querySelector(\"head\")!.appendChild(script);\n    }));\n  }\n}\n\nexport const googleAPI = new GoogleAPI({\n  clientId: process.env.REACT_APP_GOOGLE_API_CLIENT_ID!,\n  discoveryDocs: [\n    \"https://sheets.googleapis.com/$discovery/rest?version=v4\",\n    \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\n  ],\n  scope: \"https://www.googleapis.com/auth/drive.file\",\n});\n","import { GoogleAPI } from \"../gateways/GoogleAPI\";\nimport { PuzzleConfiguration, Session } from \"../models\";\n\n/**\n * Implements records synchronization with Google Spreadsheet.\n */\nexport class SyncRecords {\n  private getFileP?: Promise<gapi.client.drive.File>;\n\n  constructor(private readonly googleAPI: GoogleAPI) {}\n\n  public async uploadSession(\n    spreadsheetId: string,\n    { name, puzzleType, records }: Session\n  ) {\n    await this.googleAPI.signIn();\n    const gapi = await this.googleAPI.load();\n    const values = records.map(({ scramble, time, timestamp }) => {\n      return [name, new Date(timestamp).toLocaleString(), time, scramble];\n    });\n    const gameLongName = PuzzleConfiguration[puzzleType].longName;\n    await this.ensureSheet(spreadsheetId, gameLongName);\n    await (gapi.client.sheets.spreadsheets.values.append as any)(\n      {\n        range: `'${gameLongName}'!A1`,\n        spreadsheetId,\n        valueInputOption: \"USER_ENTERED\",\n      },\n      { values }\n    );\n  }\n\n  public async getFile(): Promise<gapi.client.drive.File> {\n    if (this.getFileP) {\n      return this.getFileP;\n    }\n\n    return (this.getFileP = (async () => {\n      const gapi = await this.googleAPI.load();\n      const listResp = await gapi.client.drive.files.list({\n        orderBy: \"createdTime desc\",\n      });\n      if (listResp.result.files && listResp.result.files.length > 0) {\n        return listResp.result.files[0];\n      }\n\n      const createResp = await (gapi.client.drive.files.create as any)(\n        {},\n        {\n          mimeType: \"application/vnd.google-apps.spreadsheet\",\n          name: \"Speedcubing records\",\n        }\n      );\n      return createResp.result;\n    })());\n  }\n\n  private async ensureSheet(spreadsheetId: string, name: string) {\n    const gapi = await this.googleAPI.load();\n    const sheetInfo = await gapi.client.sheets.spreadsheets.get({\n      spreadsheetId,\n    });\n    if (\n      sheetInfo.result.sheets!.some((sheet) => sheet.properties!.title === name)\n    ) {\n      return;\n    }\n\n    await (gapi.client.sheets.spreadsheets.batchUpdate as any)(\n      { spreadsheetId },\n      {\n        requests: [{ addSheet: { properties: { title: name } } }],\n      }\n    );\n  }\n}\n","export interface Record {\n  scramble: string;\n  time: number;\n  timestamp: number;\n}\n\nexport interface ResultStats {\n  averageOf: {\n    [n: number]: ResultStatsEntry;\n  };\n  single?: ResultStatsEntry;\n}\n\nexport interface Session {\n  name?: string;\n  puzzleType: PuzzleType;\n  records: Record[];\n}\n\ninterface ResultStatsEntry {\n  best: number;\n  current: number;\n  worst: number;\n}\n\nexport function calcStats(results?: Record[]): ResultStats {\n  if (!results || results.length === 0) {\n    return {\n      averageOf: {},\n    };\n  }\n\n  const scores = results.map((result) => result.time);\n  return {\n    averageOf: [5, 12, 100].reduce((a, n) => {\n      const aa = scores.length >= n ? variousAveragesOf(n, scores) : null;\n      return { ...a, [n]: aa };\n    }, {}),\n    single: {\n      best: Math.min(...scores),\n      current: scores[scores.length - 1],\n      worst: Math.max(...scores),\n    },\n  };\n}\n\nfunction meanOf(scores: number[]) {\n  return scores.reduce((a, b) => a + b, 0) / scores.length;\n}\n\nfunction averageOf(scores: number[]) {\n  const sorted = scores.slice().sort((a, b) => (a < b ? 1 : a > b ? -1 : 0));\n  return meanOf(sorted.slice(1, sorted.length - 1));\n}\n\nfunction slicesFrom<T>(n: number, array: T[]): T[][] {\n  return new Array(array.length - n + 1)\n    .fill(null)\n    .map((_, i) => array.slice(i, i + n));\n}\n\nexport function variousAveragesOf(\n  n: number,\n  scores: number[]\n): ResultStatsEntry {\n  if (scores.length < n) {\n    throw new Error(`not enough scores: ${scores.length} < ${n}`);\n  }\n\n  const { best, worst } = slicesFrom(n, scores)\n    .map((s) => averageOf(s))\n    .reduce(\n      (curr, v) => {\n        return {\n          best: Math.min(v, curr.best),\n          worst: Math.max(v, curr.worst),\n        };\n      },\n      { best: Number.MAX_VALUE, worst: Number.MIN_VALUE }\n    );\n\n  return {\n    best,\n    current: averageOf(scores.slice(-n)),\n    worst,\n  };\n}\n\nexport function formatDuration(n: undefined): undefined;\nexport function formatDuration(n: number): string;\nexport function formatDuration(n: number | undefined) {\n  if (n === undefined) {\n    return undefined;\n  }\n\n  const subsecs = n.toString().split(/\\./)[1] || \"\";\n  const mins = Math.floor(n / 60);\n  const secs = Math.floor(n % 60);\n\n  const padLeft = (s: string, c: string): string => {\n    if (s.length === 2) {\n      return s;\n    }\n    return c + s;\n  };\n\n  return (\n    (mins ? `${mins}:` : \"\") +\n    padLeft(secs.toString(), mins ? \"0\" : \" \") +\n    \".\" +\n    (subsecs + \"00\").substring(0, 2)\n  );\n}\n\nexport type PuzzleType = keyof typeof PuzzleConfiguration;\n\nexport const PuzzleConfiguration = {\n  \"222\": { longName: \"2x2x2\", tnoodleImpl: \"TwoByTwoCubePuzzle\" },\n  \"333\": { longName: \"3x3x3\", tnoodleImpl: \"ThreeByThreeCubePuzzle\" },\n  \"444\": { longName: \"4x4x4\", tnoodleImpl: \"FourByFourCubePuzzle\" },\n  minx: { longName: \"Megaminx\", tnoodleImpl: \"MegaminxPuzzle\" },\n  pyram: { longName: \"Pyraminx\", tnoodleImpl: \"PyraminxPuzzle\" },\n  skewb: { longName: \"Skewb\", tnoodleImpl: \"SkewbPuzzle\" },\n  sq1: { longName: \"Square-1\", tnoodleImpl: \"SquareOnePuzzle\" },\n};\n\nexport enum ToolType {\n  Recorder = \"recorder\",\n  Stats = \"stats\",\n  Preview = \"preview\",\n}\n\nexport interface StoreState {\n  current: {\n    scramble?: string;\n    session: Session;\n  };\n\n  results: Array<{\n    isSynced: boolean;\n    session: Session;\n  }>;\n\n  auth: {\n    isAuthed?: boolean;\n  };\n\n  sync: {\n    isSyncing: boolean;\n    spreadsheetId?: string;\n  };\n\n  tool: {\n    selected: ToolType;\n  };\n\n  isPlaying?: boolean;\n}\n\nexport const initialState: StoreState = {\n  current: {\n    session: {\n      puzzleType: \"333\",\n      records: [],\n    },\n  },\n  sync: {\n    isSyncing: false,\n  },\n  auth: {},\n  results: [],\n  tool: {\n    selected: ToolType.Stats,\n  },\n};\n","import { PuzzleConfiguration } from \"./models\";\n\ntype TNoodlePuzzles = Record<keyof typeof PuzzleConfiguration, TNoodlePuzzle>;\n\ninterface TNoodlePuzzle {\n  generateScramble(): string;\n}\n\nconst TNOODLE_LOAD_TIMEOUT = 30;\n\nconst puzzlesLoaded: Promise<TNoodlePuzzles> = new Promise<TNoodlePuzzles>(\n  (resolve, reject) => {\n    (window as any).puzzlesLoaded = resolve;\n\n    setTimeout(\n      () => reject(`TNoodle load timeout after ${TNOODLE_LOAD_TIMEOUT}s`),\n      TNOODLE_LOAD_TIMEOUT * 1000\n    );\n\n    import(\"tnoodle/tnoodle\").catch(reject);\n  }\n);\n\nexport function generateScramble(\n  puzzleType: keyof TNoodlePuzzles\n): Promise<string> {\n  return puzzlesLoaded.then((puzzle) => puzzle[puzzleType].generateScramble());\n}\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAEAQAAAAO4cAyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0T//xSrMc0AAAAHdElNRQfiCBAUDBEqG2glAAAI4klEQVR42u3asW7qQBRF0TdPTp3//9dIkyJ9JDsJF7PX6oGjsYuNYe39DwCI+T89AAB4PAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQdEwP+Im1phcAULf39IJrbh0AX749+rOX5cplfMRr7Hq+z3iWXe8X3hP4Nff9KvoCAfCtsxfmthcSAM7wHwAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIKO6QGvYO/pBVStNb3A/c+cZ7j/78wTAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBAgAAggQAAAQJAAAIEgAAECQAACBIAABAkAAAgCABAABBx/QA4N7Wml4AXOEJAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIKO6QHAdXtPL4A5a00vuDdPAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAEHdMDXsF6m15wwp4e8OKc799yvn/L+aYIgN/wMT0AAM7xEwAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEHH9ICfW2t6AQDczdp7egIA8Gh+AgCAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAgSAAAQJAAAIEgAAECQAACAIAEAAEECAACCBAAABAkAAAj6BFvBJhHeZtL7AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA4LTE2VDExOjEyOjE3KzA5OjAw70uAeQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wOC0xNlQxMToxMjoxNyswOTowMJ4WOMUAAAAASUVORK5CYII=\""],"sourceRoot":""}